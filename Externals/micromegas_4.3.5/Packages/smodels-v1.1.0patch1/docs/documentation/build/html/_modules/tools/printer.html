

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tools.printer &mdash; SModelS 1.1.0patch1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SModelS 1.1.0patch1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> SModelS
          

          
          </a>

          
            
            
              <div class="version">
                1.1.0patch1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">theory package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../experiment.html">experiment package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">tools package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">SModelS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>tools.printer</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for tools.printer</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: printer</span>
<span class="sd">   :synopsis: Facility used to print elements, theorypredictions, missing topologies et al</span>
<span class="sd">      in various forms</span>

<span class="sd">.. moduleauthor:: Wolfgang Magerl &lt;wolfgang.magerl@gmail.com&gt;</span>
<span class="sd">.. moduleauthor:: Ursula Laa &lt;ursula.laa@lpsc.in2p3.fr&gt;</span>
<span class="sd">.. moduleauthor:: Suchita Kulkanri &lt;suchita.kulkarni@gmail.com&gt;</span>
<span class="sd">.. moduleauthor:: Andre Lessa &lt;lessa.a.p@gmail.com&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">from</span> <span class="nn">smodels.theory.topology</span> <span class="kn">import</span> <span class="n">TopologyList</span>
<span class="kn">from</span> <span class="nn">smodels.theory.element</span> <span class="kn">import</span> <span class="n">Element</span>
<span class="kn">from</span> <span class="nn">smodels.theory.theoryPrediction</span> <span class="kn">import</span> <span class="n">TheoryPredictionList</span>
<span class="kn">from</span> <span class="nn">smodels.experiment.expResultObj</span> <span class="kn">import</span> <span class="n">ExpResult</span>
<span class="kn">from</span> <span class="nn">smodels.experiment.databaseObj</span> <span class="kn">import</span> <span class="n">ExpResultList</span>
<span class="kn">from</span> <span class="nn">smodels.tools.ioObjects</span> <span class="kn">import</span> <span class="n">OutputStatus</span><span class="p">,</span> <span class="n">ResultList</span>
<span class="kn">from</span> <span class="nn">smodels.tools.coverage</span> <span class="kn">import</span> <span class="n">UncoveredList</span><span class="p">,</span> <span class="n">Uncovered</span>
<span class="kn">from</span> <span class="nn">smodels.tools.physicsUnits</span> <span class="kn">import</span> <span class="n">GeV</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">TeV</span>
<span class="kn">from</span> <span class="nn">smodels.theory.exceptions</span> <span class="kn">import</span> <span class="n">SModelSTheoryError</span> <span class="k">as</span> <span class="n">SModelSError</span>
<span class="kn">from</span> <span class="nn">smodels.tools.smodelsLogging</span> <span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">xml.dom</span> <span class="kn">import</span> <span class="n">minidom</span>
<span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementTree</span>



<div class="viewcode-block" id="MPrinter"><a class="viewcode-back" href="../../tools.html#tools.printer.MPrinter">[docs]</a><span class="k">class</span> <span class="nc">MPrinter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Master Printer class to handle the Printers (one printer/output type)</span>
<span class="sd">    </span>
<span class="sd">    :ivar printerList: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;master&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Printers</span> <span class="o">=</span> <span class="p">{}</span>
    
<div class="viewcode-block" id="MPrinter.setPrinterOptions"><a class="viewcode-back" href="../../tools.html#tools.printer.MPrinter.setPrinterOptions">[docs]</a>    <span class="k">def</span> <span class="nf">setPrinterOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parser</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Define the printer types and their options.</span>
<span class="sd">        </span>
<span class="sd">        :param parser: ConfigParser storing information from the parameters file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#Define the printer types and the printer-specific options:</span>
        <span class="n">printerTypes</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;printer&quot;</span><span class="p">,</span> <span class="s2">&quot;outputType&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>        
        <span class="k">for</span> <span class="n">prt</span> <span class="ow">in</span> <span class="n">printerTypes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prt</span> <span class="o">==</span> <span class="s1">&#39;python&#39;</span><span class="p">:</span>
                <span class="n">newPrinter</span> <span class="o">=</span> <span class="n">PyPrinter</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span>                
            <span class="k">elif</span> <span class="n">prt</span> <span class="o">==</span> <span class="s1">&#39;summary&#39;</span><span class="p">:</span>        
                <span class="n">newPrinter</span> <span class="o">=</span> <span class="n">SummaryPrinter</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">prt</span> <span class="o">==</span> <span class="s1">&#39;stdout&#39;</span><span class="p">:</span>
                <span class="n">newPrinter</span> <span class="o">=</span> <span class="n">TxTPrinter</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;stdout&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">prt</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
                <span class="n">newPrinter</span> <span class="o">=</span> <span class="n">TxTPrinter</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">prt</span> <span class="o">==</span> <span class="s1">&#39;xml&#39;</span><span class="p">:</span>
                <span class="n">newPrinter</span> <span class="o">=</span> <span class="n">XmlPrinter</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span>            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown printer format: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">prt</span><span class="p">))</span>
                <span class="k">continue</span>
            
            <span class="c1">#Copy stdout options to log options:</span>
            <span class="k">if</span> <span class="s1">&#39;log&#39;</span> <span class="ow">in</span> <span class="n">printerTypes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">parser</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s1">&#39;stdout-printer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parser</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s1">&#39;log-printer&#39;</span><span class="p">):</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s1">&#39;log-printer&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">option</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s1">&#39;stdout-printer&#39;</span><span class="p">):</span>
                        <span class="n">parser</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;log-printer&#39;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
            
            <span class="c1">#Set printer-specific options:</span>
            <span class="k">if</span> <span class="n">parser</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="n">prt</span><span class="o">+</span><span class="s1">&#39;-printer&#39;</span><span class="p">):</span>
                <span class="n">newPrinter</span><span class="o">.</span><span class="n">setOptions</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">prt</span><span class="o">+</span><span class="s1">&#39;-printer&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Printers</span><span class="p">[</span><span class="n">prt</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPrinter</span></div>
            
                


<div class="viewcode-block" id="MPrinter.addObj"><a class="viewcode-back" href="../../tools.html#tools.printer.MPrinter.addObj">[docs]</a>    <span class="k">def</span> <span class="nf">addObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the object to all its Printers:</span>
<span class="sd">        </span>
<span class="sd">        :param obj: An object which can be handled by the Printers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">prt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Printers</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">prt</span><span class="o">.</span><span class="n">addObj</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MPrinter.setOutPutFiles"><a class="viewcode-back" href="../../tools.html#tools.printer.MPrinter.setOutPutFiles">[docs]</a>    <span class="k">def</span> <span class="nf">setOutPutFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the basename for the output files. Each printer will</span>
<span class="sd">        use this file name appended of the respective extension </span>
<span class="sd">        (i.e. .py for a python printer, .smodels for a summary printer,...)</span>
<span class="sd">        </span>
<span class="sd">        :param filename: Input file name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">printer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Printers</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">printer</span><span class="o">.</span><span class="n">setOutPutFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>


<div class="viewcode-block" id="MPrinter.flush"><a class="viewcode-back" href="../../tools.html#tools.printer.MPrinter.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ask all printers to write the output and clear their cache.</span>
<span class="sd">        If the printers return anything other than None, </span>
<span class="sd">        we pass it on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">printerType</span><span class="p">,</span><span class="n">printer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Printers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ret</span><span class="p">[</span><span class="n">printerType</span><span class="p">]</span> <span class="o">=</span> <span class="n">printer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ret</span></div></div>

<div class="viewcode-block" id="BasicPrinter"><a class="viewcode-back" href="../../tools.html#tools.printer.BasicPrinter">[docs]</a><span class="k">class</span> <span class="nc">BasicPrinter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Super class to handle the basic printing methods</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;basic&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">outputList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Removing file </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span>

    <span class="nd">@filename.setter</span>
    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="o">=</span><span class="n">fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

<div class="viewcode-block" id="BasicPrinter.mkdir"><a class="viewcode-back" href="../../tools.html#tools.printer.BasicPrinter.mkdir">[docs]</a>    <span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="bp">self</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; create directory to file, if necessary &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span> <span class="p">(</span> <span class="n">dirname</span> <span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span> <span class="p">(</span> <span class="n">dirname</span> <span class="p">)</span></div>
            
<div class="viewcode-block" id="BasicPrinter.setOptions"><a class="viewcode-back" href="../../tools.html#tools.printer.BasicPrinter.setOptions">[docs]</a>    <span class="k">def</span> <span class="nf">setOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Store the printer specific options to control the output of each printer.</span>
<span class="sd">        Each option is stored as a printer attribute.</span>
<span class="sd">        </span>
<span class="sd">        :param options: a list of (option,value) for the printer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">opt</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opt</span><span class="p">,</span><span class="nb">eval</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>        </div>
            
<div class="viewcode-block" id="BasicPrinter.addObj"><a class="viewcode-back" href="../../tools.html#tools.printer.BasicPrinter.addObj">[docs]</a>    <span class="k">def</span> <span class="nf">addObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds object to the Printer. </span>
<span class="sd">        </span>
<span class="sd">        :param obj: A object to be printed. Must match one of the types defined in formatObj</span>

<span class="sd">        :return: True if the object has been added to the output. If the object does not belong</span>
<span class="sd">                to the pre-defined printing list toPrint, returns False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">iobj</span><span class="p">,</span><span class="n">objType</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objType</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span><span class="p">[</span><span class="n">iobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="BasicPrinter.openOutFile"><a class="viewcode-back" href="../../tools.html#tools.printer.BasicPrinter.openOutFile">[docs]</a>    <span class="k">def</span> <span class="nf">openOutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; creates and opens a data sink, </span>
<span class="sd">            creates path if needed &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span> <span class="p">(</span> <span class="n">filename</span> <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span> <span class="p">(</span> <span class="n">d</span> <span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span> <span class="p">(</span> <span class="n">d</span> <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span> <span class="s2">&quot;creating directory </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">d</span> <span class="p">)</span>
        <span class="k">return</span> <span class="nb">open</span> <span class="p">(</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span> <span class="p">)</span></div>


<div class="viewcode-block" id="BasicPrinter.flush"><a class="viewcode-back" href="../../tools.html#tools.printer.BasicPrinter.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format the objects added to the output, print them to the screen</span>
<span class="sd">        or file and remove them from the printer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">iobj</span><span class="p">,</span><span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatObj</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span> <span class="k">continue</span>  <span class="c1">#Skip empty output                </span>
                <span class="n">ret</span> <span class="o">+=</span> <span class="n">output</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;stdout&#39;</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Filename not defined for printer&#39;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="bp">False</span>   
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">openOutFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
                        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                        <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>  <span class="c1">#Reset printing objects</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="k">def</span> <span class="nf">_formatObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for formatting the output depending on the type of object</span>
<span class="sd">        and output.</span>
<span class="sd">        </span>
<span class="sd">        :param obj: A object to be printed. Must match one of the types defined in formatObj</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">typeStr</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formatFunction</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_format&#39;</span><span class="o">+</span><span class="n">typeStr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">formatFunction</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Error formating object </span><span class="si">%s</span><span class="s1">: </span><span class="se">\n</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">typeStr</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">False</span></div>


<div class="viewcode-block" id="TxTPrinter"><a class="viewcode-back" href="../../tools.html#tools.printer.TxTPrinter">[docs]</a><span class="k">class</span> <span class="nc">TxTPrinter</span><span class="p">(</span><span class="n">BasicPrinter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Printer class to handle the printing of one single text output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;stdout&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">BasicPrinter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span> <span class="o">=</span> <span class="p">[</span><span class="n">OutputStatus</span><span class="p">,</span><span class="n">ExpResultList</span><span class="p">,</span><span class="n">TopologyList</span><span class="p">,</span>
                             <span class="n">ResultList</span><span class="p">,</span><span class="n">Uncovered</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>        
        
<div class="viewcode-block" id="TxTPrinter.setOutPutFile"><a class="viewcode-back" href="../../tools.html#tools.printer.TxTPrinter.setOutPutFile">[docs]</a>    <span class="k">def</span> <span class="nf">setOutPutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the basename for the text printer. The output filename will be</span>
<span class="sd">        filename.log.</span>
<span class="sd">        </span>
<span class="sd">        :param filename: Base filename</span>
<span class="sd">        :param overwrite: If True and the file already exists, it will be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>    
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Removing old output file &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span></div>
            
    <span class="k">def</span> <span class="nf">_formatDoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">_formatOutputStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a OutputStatus object.</span>

<span class="sd">        :param obj: A OutputStatus object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Input status: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">filestatus</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Decomposition output status: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">status</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">statusStrings</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">filestatus</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">warnings</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;# Input File: &quot;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">inputfile</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1"># for label, par in obj.parameters.items():</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">par</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">par</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">databaseVersion</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;# Database version: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">databaseVersion</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">output</span>


    <span class="k">def</span> <span class="nf">_formatTopologyList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a TopologyList object.</span>

<span class="sd">        :param obj: A TopologyList object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;printdecomp&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">printdecomp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">old_vertices</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;   ======================================================= </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t\t\t\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Topologies Table </span><span class="se">\t\t</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> ||</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t\t\t\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;   ======================================================= </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">old_vertices</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">vertnumb</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> .................................................. </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;===================================================== </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Topology:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Number of vertices: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">vertnumb</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">old_vertices</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">vertnumb</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Number of vertex parts: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">vertparts</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">totxsec</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">getTotalWeight</span><span class="p">()</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Total Global topology weight :</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">totxsec</span><span class="o">.</span><span class="n">niceStr</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Total Number of Elements: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">elementList</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;addelementinfo&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">addelementinfo</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">elementList</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> &quot;</span><span class="o">+</span> <span class="mi">73</span> <span class="o">*</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> Element: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatElement</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">output</span>


    <span class="k">def</span> <span class="nf">_formatElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a Element object.</span>

<span class="sd">        :param obj: A Element object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> Element ID: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">elID</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> Particles in element: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getParticles</span><span class="p">())</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> The element masses are </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getMasses</span><span class="p">()):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> Branch </span><span class="si">%i</span><span class="s2">: &quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> The element PIDs are </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">pidlist</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">getPIDs</span><span class="p">():</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> PIDs: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pidlist</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2"> The element weights are: </span><span class="se">\n</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">niceStr</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> &quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span>


    <span class="k">def</span> <span class="nf">_formatExpResultList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a ExpResultList object.</span>

<span class="sd">        :param obj: A ExpResultList object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;printdatabase&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">printdatabase</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;   ======================================================= </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t\t\t\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Selected Experimental Results </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> ||</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t\t\t\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;   ======================================================= </span><span class="se">\n</span><span class="s2">&quot;</span>
        

        <span class="k">for</span> <span class="n">expRes</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">expResultList</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatExpResult</span><span class="p">(</span><span class="n">expRes</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>


    <span class="k">def</span> <span class="nf">_formatExpResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a ExpResult object.</span>

<span class="sd">        :param obj: A ExpResult object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">txnames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">txname</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">txnameList</span><span class="p">:</span>
                <span class="n">tx</span> <span class="o">=</span> <span class="n">txname</span><span class="o">.</span><span class="n">txName</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">txnames</span><span class="p">:</span> <span class="n">txnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>


        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;========================================================</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Experimental Result ID: &quot;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Tx Labels: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">txnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Sqrts: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;addanainfo&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">addanainfo</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> -----------------------------</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Elements tested by analysis:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">listOfelements</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">txname</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">txnameList</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">txname</span><span class="o">.</span><span class="n">_topologyList</span><span class="o">.</span><span class="n">getElements</span><span class="p">():</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="ow">in</span> <span class="n">listOfelements</span><span class="p">:</span> <span class="n">listOfelements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">listOfelements</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">    &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">output</span>
    

    <span class="k">def</span> <span class="nf">_formatResultList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a ResultList object.</span>

<span class="sd">        :param obj: A ResultList object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;   ======================================================= </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t\t\t\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> Theory Predictions and </span><span class="se">\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> Experimental Constraints </span><span class="se">\t\t</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> ||</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; || </span><span class="se">\t</span><span class="s2"> </span><span class="se">\t\t\t\t\t\t</span><span class="s2"> || </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;   ======================================================= </span><span class="se">\n</span><span class="s2">&quot;</span>
                
        
        <span class="k">for</span> <span class="n">theoryPrediction</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">theoryPredictions</span><span class="p">:</span>
            <span class="n">expRes</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">expResult</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;---------------Analysis Label = &quot;</span> <span class="o">+</span> <span class="n">expRes</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;-------------------Dataset Label = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">dataId</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;None&quot;</span><span class="p">,</span><span class="s2">&quot;(UL)&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;-------------------Txname Labels = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">txname</span><span class="p">)</span> <span class="k">for</span> <span class="n">txname</span> <span class="ow">in</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">txnames</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Analysis sqrts: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">expRes</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Theory prediction: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">xsection</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Theory conditions:&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">conditions</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condlist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
                    <span class="n">condlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">conditions</span><span class="p">[</span><span class="n">cond</span><span class="p">])</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">condlist</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="c1">#Get upper limit for the respective prediction:</span>
            <span class="k">if</span> <span class="n">expRes</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="s1">&#39;upperLimit&#39;</span><span class="p">:</span>
                <span class="n">upperLimit</span> <span class="o">=</span> <span class="n">expRes</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">txname</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">txnames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mass</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
                <span class="n">upperLimitExp</span> <span class="o">=</span> <span class="n">expRes</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">txname</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">txnames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mass</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span><span class="n">expected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">expRes</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="s1">&#39;efficiencyMap&#39;</span><span class="p">:</span>
                <span class="n">upperLimit</span> <span class="o">=</span> <span class="n">expRes</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">dataID</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataId</span><span class="p">)</span>
                <span class="n">upperLimitExp</span> <span class="o">=</span> <span class="n">expRes</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">dataID</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataId</span><span class="p">,</span><span class="n">expected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Observed experimental limit: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">upperLimit</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">upperLimitExp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Expected experimental limit: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">upperLimitExp</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="p">,</span><span class="s1">&#39;chi2&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">chi2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Chi2: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">chi2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Likelihood: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">likelihood</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;printextendedresults&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">printextendedresults</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">mass</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ibr</span><span class="p">,</span> <span class="n">br</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">mass</span><span class="p">):</span>
                        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Masses in branch </span><span class="si">%i</span><span class="s2">: &quot;</span> <span class="o">%</span> <span class="n">ibr</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">br</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">IDs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Contributing elements: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">IDs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">pidList</span> <span class="ow">in</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">PIDs</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;PIDs:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pidList</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>


        <span class="k">return</span> <span class="n">output</span>


    <span class="k">def</span> <span class="nf">_formatUncovered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format all uncovered data.</span>
<span class="sd">        </span>
<span class="sd">        :param obj: Uncovered object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
                
        <span class="n">nprint</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of missing topologies to be printed (ordered by cross sections)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total missing topology cross section (fb): </span><span class="si">%10.3E</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getMissingXsec</span><span class="p">())</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Total cross section where we are outside the mass grid (fb): </span><span class="si">%10.3E</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getOutOfGridXsec</span><span class="p">())</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Total cross section in long cascade decays (fb): </span><span class="si">%10.3E</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getLongCascadeXsec</span><span class="p">())</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Total cross section in decays with asymmetric branches (fb): </span><span class="si">%10.3E</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getAsymmetricXsec</span><span class="p">())</span>        
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Full information on unconstrained cross sections</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;================================================================================</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">uncovEntry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">outsideGrid</span><span class="p">]):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uncovEntry</span><span class="o">.</span><span class="n">topos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;No missing topologies found</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;No contributions outside the mass grid</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">uncovEntry</span><span class="o">.</span><span class="n">topos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">topo</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="k">continue</span>
                    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">contributingElements</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">sqrts</span><span class="p">):</span> <span class="k">continue</span>
                        <span class="n">topo</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">el</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ix</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Missing topologies with the highest cross sections (up to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nprint</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;):</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Contributions outside the mass grid (up to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nprint</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;):</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Sqrts (TeV)   Weight (fb)        Element description</span><span class="se">\n</span><span class="s2">&quot;</span>        
                <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">uncovEntry</span><span class="o">.</span><span class="n">topos</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="n">nprint</span><span class="p">]:</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%5s</span><span class="s2"> </span><span class="si">%10.3E</span><span class="s2">    # </span><span class="si">%45s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">)),</span><span class="n">topo</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">topo</span><span class="p">))</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;addcoverageid&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">addcoverageid</span><span class="p">:</span>
                        <span class="n">contributing</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">contributingElements</span><span class="p">:</span>
                            <span class="n">contributing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">elID</span><span class="p">)</span>
                        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Contributing elements </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">contributing</span><span class="p">)</span>            
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;================================================================================</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">uncovEntry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">longCascade</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">asymmetricBranches</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ix</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Long cascade decay by produced mothers (up to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nprint</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;):</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Asymmetric branch decay by produced mothers</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Mother1 Mother2 Weight (fb) # allMothers</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">uncovEntry</span><span class="o">.</span><span class="n">getSorted</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)[:</span><span class="n">nprint</span><span class="p">]:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%10.3E</span><span class="s2"> # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ent</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ent</span><span class="o">.</span><span class="n">getWeight</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;addcoverageid&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">addcoverageid</span><span class="p">:</span>
                    <span class="n">contributing</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">ent</span><span class="o">.</span><span class="n">contributingElements</span><span class="p">:</span>
                        <span class="n">contributing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">elID</span><span class="p">)</span>
                    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;Contributing elements </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">contributing</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ix</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;================================================================================</span><span class="se">\n</span><span class="s2">&quot;</span>
        
        <span class="k">return</span> <span class="n">output</span></div>
                      

<div class="viewcode-block" id="SummaryPrinter"><a class="viewcode-back" href="../../tools.html#tools.printer.SummaryPrinter">[docs]</a><span class="k">class</span> <span class="nc">SummaryPrinter</span><span class="p">(</span><span class="n">TxTPrinter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Printer class to handle the printing of one single summary output.</span>
<span class="sd">    It uses the facilities of the TxTPrinter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;stdout&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">TxTPrinter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;summary&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span> <span class="o">=</span> <span class="p">[</span><span class="n">OutputStatus</span><span class="p">,</span><span class="n">ResultList</span><span class="p">,</span> <span class="n">Uncovered</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>
        
    
<div class="viewcode-block" id="SummaryPrinter.setOutPutFile"><a class="viewcode-back" href="../../tools.html#tools.printer.SummaryPrinter.setOutPutFile">[docs]</a>    <span class="k">def</span> <span class="nf">setOutPutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the basename for the text printer. The output filename will be</span>
<span class="sd">        filename.smodels.</span>
<span class="sd">        :param filename: Base filename</span>
<span class="sd">        :param overwrite: If True and the file already exists, it will be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;.smodels&#39;</span>
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Removing old output file &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span></div>
            
            
    <span class="k">def</span> <span class="nf">_formatResultList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data of the ResultList object.</span>

<span class="sd">        :param obj: A ResultList object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">obj</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;expandedsummary&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expandedsummary</span><span class="p">:</span>                       
            <span class="n">theoPredictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">theoryPredictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">theoPredictions</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">theoryPredictions</span>

        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">rvalues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;#Analysis  Sqrts  Cond_Violation  Theory_Value(fb)  Exp_limit(fb)  r  r_expected&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">theoPred</span> <span class="ow">in</span> <span class="n">theoPredictions</span><span class="p">:</span>
            <span class="n">expResult</span> <span class="o">=</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">expResult</span>
            <span class="n">datasetID</span> <span class="o">=</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataId</span>
            <span class="n">dataType</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataType</span>
            <span class="n">txnames</span> <span class="o">=</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">txnames</span>
            <span class="k">if</span> <span class="n">dataType</span> <span class="o">==</span> <span class="s1">&#39;upperLimit&#39;</span><span class="p">:</span>
                <span class="n">ul</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">txname</span><span class="o">=</span><span class="n">theoPred</span><span class="o">.</span><span class="n">txnames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mass</span><span class="o">=</span><span class="n">theoPred</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
                <span class="n">ul_expected</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">txname</span><span class="o">=</span><span class="n">theoPred</span><span class="o">.</span><span class="n">txnames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mass</span><span class="o">=</span><span class="n">theoPred</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">expected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">signalRegion</span>  <span class="o">=</span> <span class="s1">&#39;(UL)&#39;</span>
            <span class="k">elif</span> <span class="n">dataType</span> <span class="o">==</span> <span class="s1">&#39;efficiencyMap&#39;</span><span class="p">:</span>
                <span class="n">ul</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">dataID</span><span class="o">=</span><span class="n">datasetID</span><span class="p">)</span>
                <span class="n">ul_expected</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">dataID</span><span class="o">=</span><span class="n">datasetID</span><span class="p">,</span> <span class="n">expected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">signalRegion</span>  <span class="o">=</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataId</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Unknown dataType </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dataType</span><span class="p">)))</span>
                <span class="k">raise</span> <span class="n">SModelSError</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">xsection</span><span class="o">.</span><span class="n">value</span>

            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="o">/</span><span class="n">ul</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ul_expected</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">):</span> <span class="n">r_expected</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">r_expected</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="o">/</span><span class="n">ul_expected</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">()</span>
            <span class="n">rvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%19s</span><span class="s2">  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expResult</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  <span class="c1"># ana</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%4s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expResult</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">sqrts</span><span class="o">/</span> <span class="n">TeV</span><span class="p">)</span>  <span class="c1"># sqrts</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%5s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">getmaxCondition</span><span class="p">()</span>  <span class="c1"># condition violation</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%10.3E</span><span class="s2"> </span><span class="si">%10.3E</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">),</span> <span class="n">ul</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">))</span>  <span class="c1"># theory cross section , expt upper limit</span>
            <span class="k">if</span> <span class="n">r_expected</span><span class="p">:</span> <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%10.3E</span><span class="s2"> </span><span class="si">%10.3E</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_expected</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%10.3E</span><span class="s2">  N/A&quot;</span> <span class="o">%</span><span class="n">r</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; Signal Region:  &quot;</span><span class="o">+</span><span class="n">signalRegion</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">txnameStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span> <span class="k">for</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">txnames</span><span class="p">])</span>
            <span class="n">txnameStr</span> <span class="o">=</span> <span class="n">txnameStr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; Txnames:  &quot;</span> <span class="o">+</span> <span class="n">txnameStr</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">theoPred</span><span class="p">,</span><span class="s1">&#39;expectedUL&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">expectedUL</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot; Chi2, Likelihood = </span><span class="si">%10.3E</span><span class="s2"> </span><span class="si">%10.3E</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">theoPred</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="n">theoPred</span><span class="o">.</span><span class="n">likelihood</span><span class="p">)</span>            
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">theoPred</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="n">theoryPredictions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">output</span> <span class="o">+=</span> <span class="mi">80</span> <span class="o">*</span> <span class="s2">&quot;-&quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="mi">80</span> <span class="o">*</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;The highest r value is = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">rvalues</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">output</span></div>
            


<div class="viewcode-block" id="PyPrinter"><a class="viewcode-back" href="../../tools.html#tools.printer.PyPrinter">[docs]</a><span class="k">class</span> <span class="nc">PyPrinter</span><span class="p">(</span><span class="n">BasicPrinter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Printer class to handle the printing of one single pythonic output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;stdout&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">BasicPrinter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;py&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span> <span class="o">=</span> <span class="p">[</span><span class="n">OutputStatus</span><span class="p">,</span><span class="n">TopologyList</span><span class="p">,</span><span class="n">ResultList</span><span class="p">,</span><span class="n">Uncovered</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>
        
<div class="viewcode-block" id="PyPrinter.setOutPutFile"><a class="viewcode-back" href="../../tools.html#tools.printer.PyPrinter.setOutPutFile">[docs]</a>    <span class="k">def</span> <span class="nf">setOutPutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the basename for the text printer. The output filename will be</span>
<span class="sd">        filename.py.</span>
<span class="sd">        :param filename: Base filename</span>
<span class="sd">        :param overwrite: If True and the file already exists, it will be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;.py&#39;</span>
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Removing old output file &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPrinter.flush"><a class="viewcode-back" href="../../tools.html#tools.printer.PyPrinter.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the python dictionaries generated by the object formatting</span>
<span class="sd">        to the defined output</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">outputDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">iobj</span><span class="p">,</span><span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatObj</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>                
            <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span> <span class="k">continue</span>  <span class="c1">#Skip empty output</span>
            <span class="n">outputDict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                
        <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;smodelsOutput = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">outputDict</span><span class="p">)</span>      
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;stdout&#39;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Filename not defined for printer&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>                
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>
        <span class="c1">## it is a special feature of the python printer</span>
        <span class="c1">## that we also return the output dictionary</span>
        <span class="k">return</span> <span class="n">outputDict</span></div>


    <span class="k">def</span> <span class="nf">_formatTopologyList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a TopologyList object.</span>

<span class="sd">        :param obj: A TopologyList object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
                
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;addelementlist&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">addelementlist</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">elementList</span><span class="p">:</span>
                <span class="n">thisEl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatElement</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thisEl</span><span class="p">:</span> <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEl</span><span class="p">)</span>
                
        
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;Element&quot;</span><span class="p">:</span> <span class="n">elements</span><span class="p">}</span>


    <span class="k">def</span> <span class="nf">_formatElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a Element object.</span>

<span class="sd">        :param obj: A Element object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">elDic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">elDic</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">elID</span>
        <span class="n">elDic</span><span class="p">[</span><span class="s2">&quot;Particles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getParticles</span><span class="p">())</span>
        <span class="n">elDic</span><span class="p">[</span><span class="s2">&quot;Masses (GeV)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="n">m</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">GeV</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">br</span><span class="p">]</span> <span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">getMasses</span><span class="p">()]</span>
        <span class="n">elDic</span><span class="p">[</span><span class="s2">&quot;PIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getPIDs</span><span class="p">()</span>
        <span class="n">elDic</span><span class="p">[</span><span class="s2">&quot;Weights (fb)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sqrts</span> <span class="o">=</span> <span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">sqrts</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()]</span>
        <span class="n">allsqrts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sqrts</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">sqrts</span> <span class="ow">in</span> <span class="n">allsqrts</span><span class="p">:</span>
            <span class="n">xsecs</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsec</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span> <span class="k">for</span> <span class="n">xsec</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">sqrts</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xsecs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Element cross sections contain multiple values for </span><span class="si">%s</span><span class="s2"> .</span><span class="se">\</span>
<span class="s2">                Only the first cross section will be printed&quot;</span> <span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">sqrt</span><span class="p">))</span>
            <span class="n">xsecs</span> <span class="o">=</span> <span class="n">xsecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sqrtsStr</span> <span class="o">=</span> <span class="s1">&#39;xsec &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; TeV&#39;</span>
            <span class="n">elDic</span><span class="p">[</span><span class="s2">&quot;Weights (fb)&quot;</span><span class="p">][</span><span class="n">sqrtsStr</span><span class="p">]</span> <span class="o">=</span> <span class="n">xsecs</span>
        <span class="k">return</span> <span class="n">elDic</span>


    <span class="k">def</span> <span class="nf">_formatOutputStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data for a OutputStatus object.</span>

<span class="sd">        :param obj: A OutputStatus object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">infoDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">infoDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">NameError</span><span class="p">,</span><span class="ne">TypeError</span><span class="p">):</span>
                <span class="n">infoDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>        
        <span class="n">infoDict</span><span class="p">[</span><span class="s1">&#39;file status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">filestatus</span>
        <span class="n">infoDict</span><span class="p">[</span><span class="s1">&#39;decomposition status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">status</span>
        <span class="n">infoDict</span><span class="p">[</span><span class="s1">&#39;warnings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">warnings</span>
        <span class="n">infoDict</span><span class="p">[</span><span class="s1">&#39;input file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">inputfile</span>
        <span class="n">infoDict</span><span class="p">[</span><span class="s1">&#39;database version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">databaseVersion</span>
        <span class="n">infoDict</span><span class="p">[</span><span class="s1">&#39;smodels version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">smodelsVersion</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;OutputStatus&#39;</span> <span class="p">:</span> <span class="n">infoDict</span><span class="p">}</span>


    <span class="k">def</span> <span class="nf">_formatResultList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data of the ResultList object.</span>

<span class="sd">        :param obj: A ResultList object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        
        <span class="n">ExptRes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">theoryPrediction</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">theoryPredictions</span><span class="p">:</span>            
            <span class="n">expResult</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">expResult</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">dataset</span>
            <span class="n">expID</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">id</span>
            <span class="n">datasetID</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataId</span>
            <span class="n">dataType</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">dataInfo</span><span class="o">.</span><span class="n">dataType</span>
            <span class="k">if</span> <span class="n">dataType</span> <span class="o">==</span> <span class="s1">&#39;upperLimit&#39;</span><span class="p">:</span>
                <span class="n">ul</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">txname</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">txnames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                <span class="n">mass</span><span class="o">=</span><span class="n">theoryPrediction</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
                <span class="n">ulExpected</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">elif</span> <span class="n">dataType</span> <span class="o">==</span> <span class="s1">&#39;efficiencyMap&#39;</span><span class="p">:</span>
                <span class="n">ul</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">dataID</span><span class="o">=</span><span class="n">datasetID</span><span class="p">)</span>
                <span class="n">ulExpected</span> <span class="o">=</span> <span class="n">expResult</span><span class="o">.</span><span class="n">getUpperLimitFor</span><span class="p">(</span><span class="n">dataID</span><span class="o">=</span><span class="n">datasetID</span><span class="p">,</span> <span class="n">expected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Unknown dataType </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dataType</span><span class="p">)))</span>
                <span class="k">continue</span>            
            <span class="n">value</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">xsection</span><span class="o">.</span><span class="n">value</span>
            <span class="n">txnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">txname</span><span class="o">.</span><span class="n">txName</span> <span class="k">for</span> <span class="n">txname</span> <span class="ow">in</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">txnames</span><span class="p">]</span>
            <span class="n">maxconds</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">getmaxCondition</span><span class="p">()</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">mass</span>
            <span class="k">if</span> <span class="n">mass</span><span class="p">:</span>
                <span class="n">mass</span> <span class="o">=</span> <span class="p">[[</span><span class="n">m</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">GeV</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mbr</span><span class="p">]</span> <span class="k">for</span> <span class="n">mbr</span> <span class="ow">in</span> <span class="n">mass</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mass</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">sqrts</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">sqrts</span>
            <span class="n">resDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;maxcond&#39;</span><span class="p">:</span> <span class="n">maxconds</span><span class="p">,</span> <span class="s1">&#39;theory prediction (fb)&#39;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">),</span>
                        <span class="s1">&#39;upper limit (fb)&#39;</span><span class="p">:</span> <span class="n">ul</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">),</span>
                        <span class="s1">&#39;expected upper limit (fb)&#39;</span><span class="p">:</span> <span class="n">ulExpected</span><span class="p">,</span>
                        <span class="s1">&#39;TxNames&#39;</span><span class="p">:</span> <span class="n">txnames</span><span class="p">,</span>
                        <span class="s1">&#39;Mass (GeV)&#39;</span><span class="p">:</span> <span class="n">mass</span><span class="p">,</span>
                        <span class="s1">&#39;AnalysisID&#39;</span><span class="p">:</span> <span class="n">expID</span><span class="p">,</span>
                        <span class="s1">&#39;DataSetID&#39;</span> <span class="p">:</span> <span class="n">datasetID</span><span class="p">,</span>
                        <span class="s1">&#39;AnalysisSqrts (TeV)&#39;</span><span class="p">:</span> <span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">),</span>
                        <span class="s1">&#39;lumi (fb-1)&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">globalInfo</span><span class="o">.</span><span class="n">lumi</span><span class="o">*</span><span class="n">fb</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
                        <span class="s1">&#39;dataType&#39;</span> <span class="p">:</span> <span class="n">dataType</span><span class="p">}</span>            
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">theoryPrediction</span><span class="p">,</span><span class="s1">&#39;chi2&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">chi2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">resDict</span><span class="p">[</span><span class="s1">&#39;chi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">chi2</span>
                <span class="n">resDict</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theoryPrediction</span><span class="o">.</span><span class="n">likelihood</span>                
            <span class="n">ExptRes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resDict</span><span class="p">)</span>

        <span class="n">ExptRes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ExptRes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">res</span><span class="p">:</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;theory prediction (fb)&#39;</span><span class="p">],</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;TxNames&#39;</span><span class="p">],</span>
                                                   <span class="n">res</span><span class="p">[</span><span class="s1">&#39;AnalysisID&#39;</span><span class="p">],</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;DataSetID&#39;</span><span class="p">]])</span>
        

        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;ExptRes&#39;</span> <span class="p">:</span> <span class="n">ExptRes</span><span class="p">}</span>


    <span class="k">def</span> <span class="nf">_formatDoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format a pyslha object to be printed as a dictionary</span>

<span class="sd">        :param obj: pyslha object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">MINPAR</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;MINPAR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
        <span class="n">EXTPAR</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;EXTPAR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;MASS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">chimix</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;NMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;NMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">newkey</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">chimix</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">chamix</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;UMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;UMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">newkey</span> <span class="o">=</span> <span class="s1">&#39;U&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">chamix</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;VMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;VMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">newkey</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">chamix</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">stopmix</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;STOPMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;STOPMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">newkey</span> <span class="o">=</span> <span class="s1">&#39;ST&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">stopmix</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">sbotmix</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;SBOTMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s1">&#39;SBOTMIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">newkey</span> <span class="o">=</span> <span class="s1">&#39;SB&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">sbotmix</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;MINPAR&#39;</span> <span class="p">:</span> <span class="n">MINPAR</span><span class="p">,</span> <span class="s1">&#39;chimix&#39;</span> <span class="p">:</span> <span class="n">chimix</span><span class="p">,</span> <span class="s1">&#39;stopmix&#39;</span> <span class="p">:</span> <span class="n">stopmix</span><span class="p">,</span>
                <span class="s1">&#39;chamix&#39;</span> <span class="p">:</span> <span class="n">chamix</span><span class="p">,</span> <span class="s1">&#39;MM&#39;</span> <span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sbotmix&#39;</span> <span class="p">:</span> <span class="n">sbotmix</span><span class="p">,</span>
                <span class="s1">&#39;EXTPAR&#39;</span> <span class="p">:</span> <span class="n">EXTPAR</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span> <span class="p">:</span> <span class="n">mass</span><span class="p">}</span>

    
    <span class="k">def</span> <span class="nf">_formatUncovered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format data of the Uncovered object containing coverage info</span>

<span class="sd">        :param obj: A Uncovered object to be printed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">nprint</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of missing topologies to be printed (ordered by cross sections)</span>

        <span class="n">missedTopos</span> <span class="o">=</span> <span class="p">[]</span>
        
        
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">topos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">topo</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">contributingElements</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">sqrts</span><span class="p">):</span> <span class="k">continue</span>
                <span class="n">topo</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">el</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">topos</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">topos</span><span class="p">,</span> 
                                        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">topo</span><span class="p">)],</span> 
                                        <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>        
    
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">missingTopos</span><span class="o">.</span><span class="n">topos</span><span class="p">[:</span><span class="n">nprint</span><span class="p">]:</span>
            <span class="n">missed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sqrts (TeV)&#39;</span> <span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">),</span> <span class="s1">&#39;weight (fb)&#39;</span> <span class="p">:</span> <span class="n">topo</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                <span class="s1">&#39;element&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">topo</span><span class="p">)}</span>           
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;addelementlist&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">addelementlist</span><span class="p">:</span>
                <span class="n">contributing</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">contributingElements</span><span class="p">:</span>
                    <span class="n">contributing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">elID</span><span class="p">)</span>
                <span class="n">missed</span><span class="p">[</span><span class="s2">&quot;element IDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">contributing</span>
            <span class="n">missedTopos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">missed</span><span class="p">)</span>
            
        <span class="n">outsideGrid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">outsideGrid</span><span class="o">.</span><span class="n">topos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">topo</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">contributingElements</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">):</span> <span class="k">continue</span>
                <span class="n">topo</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">el</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">getXsecsFor</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">outsideGrid</span><span class="o">.</span><span class="n">topos</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">outsideGrid</span><span class="o">.</span><span class="n">topos</span><span class="p">,</span> 
                                       <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">topo</span><span class="p">)],</span> 
                                       <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>        
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">outsideGrid</span><span class="o">.</span><span class="n">topos</span><span class="p">[:</span><span class="n">nprint</span><span class="p">]:</span>
            <span class="n">outside</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sqrts (TeV)&#39;</span> <span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">),</span> <span class="s1">&#39;weight (fb)&#39;</span> <span class="p">:</span> <span class="n">topo</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                <span class="s1">&#39;element&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">topo</span><span class="p">)}</span>      
            <span class="n">outsideGrid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outside</span><span class="p">)</span>     
        
        <span class="n">longCascades</span> <span class="o">=</span> <span class="p">[]</span>        
        <span class="n">obj</span><span class="o">.</span><span class="n">longCascade</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">longCascade</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> 
                                         <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getWeight</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">),</span><span class="n">x</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">],</span> 
                                         <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>        
        <span class="k">for</span> <span class="n">cascadeEntry</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">longCascade</span><span class="o">.</span><span class="n">classes</span><span class="p">[:</span><span class="n">nprint</span><span class="p">]:</span>
            <span class="n">longc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sqrts (TeV)&#39;</span> <span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">),</span>
                     <span class="s1">&#39;weight (fb)&#39;</span> <span class="p">:</span> <span class="n">cascadeEntry</span><span class="o">.</span><span class="n">getWeight</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">),</span> 
                     <span class="s1">&#39;mother PIDs&#39;</span> <span class="p">:</span> <span class="n">cascadeEntry</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">}</span>        
            <span class="n">longCascades</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">longc</span><span class="p">)</span>
        
        <span class="n">asymmetricBranches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">asymmetricBranches</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">asymmetricBranches</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> 
                                                <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getWeight</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">),</span><span class="n">x</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">],</span>
                                                <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">asymmetricEntry</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">asymmetricBranches</span><span class="o">.</span><span class="n">classes</span><span class="p">[:</span><span class="n">nprint</span><span class="p">]:</span>
            <span class="n">asymmetric</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sqrts (TeV)&#39;</span> <span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">TeV</span><span class="p">),</span> 
                    <span class="s1">&#39;weight (fb)&#39;</span> <span class="p">:</span> <span class="n">asymmetricEntry</span><span class="o">.</span><span class="n">getWeight</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">sqrts</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">fb</span><span class="p">),</span>
                    <span class="s1">&#39;mother PIDs&#39;</span> <span class="p">:</span> <span class="n">asymmetricEntry</span><span class="o">.</span><span class="n">motherPIDs</span><span class="p">}</span>         
            <span class="n">asymmetricBranches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asymmetric</span><span class="p">)</span>


        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;Missed Topologies&#39;</span><span class="p">:</span> <span class="n">missedTopos</span><span class="p">,</span> <span class="s1">&#39;Long Cascades&#39;</span> <span class="p">:</span> <span class="n">longCascades</span><span class="p">,</span>
                     <span class="s1">&#39;Asymmetric Branches&#39;</span><span class="p">:</span> <span class="n">asymmetricBranches</span><span class="p">,</span> <span class="s1">&#39;Outside Grid&#39;</span><span class="p">:</span> <span class="n">outsideGrid</span><span class="p">}</span></div>
    


<div class="viewcode-block" id="XmlPrinter"><a class="viewcode-back" href="../../tools.html#tools.printer.XmlPrinter">[docs]</a><span class="k">class</span> <span class="nc">XmlPrinter</span><span class="p">(</span><span class="n">PyPrinter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Printer class to handle the printing of one single XML output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;stdout&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">PyPrinter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;xml&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span> <span class="o">=</span> <span class="p">[</span><span class="n">OutputStatus</span><span class="p">,</span><span class="n">TopologyList</span><span class="p">,</span><span class="n">ResultList</span><span class="p">,</span><span class="n">Uncovered</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>

        
<div class="viewcode-block" id="XmlPrinter.setOutPutFile"><a class="viewcode-back" href="../../tools.html#tools.printer.XmlPrinter.setOutPutFile">[docs]</a>    <span class="k">def</span> <span class="nf">setOutPutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the basename for the text printer. The output filename will be</span>
<span class="sd">        filename.xml.</span>
<span class="sd">        :param filename: Base filename</span>
<span class="sd">        :param overwrite: If True and the file already exists, it will be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Removing old output file &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>        </div>


<div class="viewcode-block" id="XmlPrinter.convertToElement"><a class="viewcode-back" href="../../tools.html#tools.printer.XmlPrinter.convertToElement">[docs]</a>    <span class="k">def</span> <span class="nf">convertToElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pyObj</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">tag</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a python object (list,dict,string,...)</span>
<span class="sd">        to a nested XML element tree.</span>
<span class="sd">        :param pyObj: python object (list,dict,string...)</span>
<span class="sd">        :param parent: XML Element parent</span>
<span class="sd">        :param tag: tag for the daughter element</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pyObj</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pyObj</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyObj</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pyObj</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pyObj</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">newElement</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertToElement</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">newElement</span><span class="p">,</span><span class="n">tag</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newElement</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pyObj</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">tag</span> <span class="o">+=</span> <span class="s1">&#39;_List&#39;</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">pyObj</span><span class="p">:</span>
                <span class="n">newElement</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertToElement</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">newElement</span><span class="p">,</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newElement</span><span class="p">)</span></div>


<div class="viewcode-block" id="XmlPrinter.flush"><a class="viewcode-back" href="../../tools.html#tools.printer.XmlPrinter.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the python dictionaries generated by the object formatting</span>
<span class="sd">        to the defined output and convert to XML</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">outputDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">iobj</span><span class="p">,</span><span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatObj</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># Conver to python dictionaries                        </span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span> <span class="k">continue</span>  <span class="c1">#Skip empty output            </span>
            <span class="n">outputDict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

        <span class="n">root</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#Convert from python dictionaries to xml:</span>
        <span class="k">if</span> <span class="n">outputDict</span><span class="p">:</span>            
            <span class="n">root</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;smodelsOutput&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertToElement</span><span class="p">(</span><span class="n">outputDict</span><span class="p">,</span><span class="n">root</span><span class="p">)</span>
            <span class="n">rough_xml</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">nice_xml</span> <span class="o">=</span> <span class="n">minidom</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">rough_xml</span><span class="p">)</span><span class="o">.</span><span class="n">toprettyxml</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="s2">&quot;    &quot;</span><span class="p">)</span>                        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;stdout&#39;</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nice_xml</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Filename not defined for printer&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">False</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nice_xml</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">nice_xml</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toPrint</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printingOrder</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">root</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, &lt;function authors at 0x7f73f74eb500&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1.0patch1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>